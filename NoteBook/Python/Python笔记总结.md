# Python笔记总结



## 基本类型

| 类型          | 详解                               |
| ------------- | ---------------------------------- |
| str(string)   | 字符串 ‘ ’、“ ”                    |
| int(integer)  | 整数 21、025、0x15                 |
| float         | 浮点数 1.65、21.0、21.、.21、2.1E1 |
| bool(boolean) | 布尔数                             |
| complex       | 复数 1+1j                          |

**type()**
可以查看参数类型，例如：`type(.21)`

**str(123)**
强制类型转换，例如：`int('123')`、`float('123')`、`bool(123)`





## 运算符

### 算数运算符
| 符号 | 作用                                                         |
| ---- | ------------------------------------------------------------ |
| +    | 加法                                                         |
| -    | 减法                                                         |
| *    | 乘法                                                         |
| /    | 除法（也可以作为多行语句的连接符）                           |
| %    | 求余                                                         |
| **   | 指数，例：`2**3=8`                                           |
| //   | 地板除（普通除法得到的结果，再取整数部分）例如：3.0/2=1而不是1.5 |

**提示：**不同类型一起运行时的转换规则：`bool` -> `int` -> `float` -> `complex`

**math模块**

```python
import math  # 引用math模块（调用math库函数）
dir(math)  # 查看模块内容
help(math.sin)  # 查看sin()函数的帮助
```



### 关系运算符
| 符号   | 解释     |
| ------ | -------- |
| ==     | 等于     |
| !=、<> | 不等于   |
| >      | 大于     |
| <      | 小于     |
| >=     | 大于等于 |
| <=     | 小于等于 |



### 逻辑运算符
| 符号 | 解释 |
| ---- | ---- |
| and  | 与   |
| or   | 或   |
| not  | 非   |



### 增量赋值运算符
| 符号 |
| ---- |
| +=   |
| -=   |
| *=   |
| /=   |
| %=   |
| **=  |

**注意：**对象操作时，a+=b与a=a+b可能会不一样。



### 运算符优先级
| 符号     | 举例                       |
| -------- | -------------------------- |
| 括号     | ( )                        |
| 一元运算 | +、-                       |
| 幂次     | **                         |
| 算术运算 | *、/、%、//                |
| 算术运算 | +、-                       |
| 比较运算 | ==、!=、<>、<=、>=         |
| 逻辑非   | not                        |
| 逻辑与   | and                        |
| 逻辑或   | or                         |
| 赋值运算 | =、*=、/=、+=、-=、%=、//= |





## 输入 & 输出

**输入**

```python
input('scanf a number:')  # 读取键盘输入，所有输入内容都将作为字符串看待
```

**输出**

```python
print(a+b)  # 输出a+b（print自带换行，在print输出后加逗号可以让它在一行上输出）

# 例：连续输出两个数
print (a,b)
```






## 字符串

**单引号**和**双引号**：当你用单引号`' '`定义字符串的时候，它就会认为你字符串里面的双引号`" "`是普通字符，从而不需要转义。反之当你用双引号定义字符串的时候，就会认为你字符串里面的单引号是普通字符无需转义。

**三引号**：多行字符串，可以保留你多行输入的格式，同时字符串中能加注释（`#`），注释不会算入字符串中。

### 字符串基本运算

```python
str='Hello'
len(str)  # 测量长度
str2=str+'Word'  # 字符串拼接（str2内容为：HelloWord）
str2*3  # 字符串重复（会产生三个str2出来，如果输出，内容为：HelloWordHelloWordHelloWord）
'ab' in 'abcd'  # 判断一个字符串是否是另一个字符串的字串（可以用来判断一个字符串是否在另一个字符串中出现）
```



### 字符串索引

> 类似于下标

| 字符串内容 | h     | e    | l    | l    | o    | w    | o    | r    | l    | d    |
| ---------- | ----- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 正序下标   | [0]   | [1]  | [2]  | [4]  | [5]  | [6]  | [7]  | [8]  | [9]  | [10] |
| 逆序下标   | [-10] | [-9] | [-8] | [-7] | [-6] | [-5] | [-4] | [-3] | [-2] | [-1] |

```python
# 例：
str='abcd'
print str[-1]  # 输出结果为：d
print str[0]  # 输出结果为：a
```



### 字符串方法

**替换字符串的某个元素的值为另一个值**

```python
# 例：
str='01010'
str=str.replace('0', '9')  # 将字符0替换为9
print(str)  # 输出结果：91919
```

**其他字符串方法**

```python
dir(str)  # 打印字符串所有方法
find(' ')  # 输出第一个符合条件的字符的下标，如果没找到输出-1 例：print aaa.find('i') #输出结果为：1
```

### 字符串前缀

**r：**除去转义字符，`\n`这种转义字符不再起效果，一般用在网址、文件路径上，这样就不用对路径中的斜杠进行额外的解释了。例如：`r'C:\Users\xxxx\Desktop'` 

**u：**表示Unicode字符串，一般用在中文字符串上，例如：`u'这是一个中文字符串'`

**b：**表示字节（`bytes`）类型的，在网络传输中，一般都得将普通字符串转换成字节类型才能传输

**f：**表示字符串中的python表达式是可运行的，例如：`f'username is {name}'`，其中`name`为程序之前定义好的变量





## 切片
>截取列表中的一段

**参数：**`str[start : finish]` ，从下标为`start开始`到下标为`finish-1结束`。

```python
# 例：
str='0123456'
print str[2:4]  # 运行结果为：23
print str[:4]  # 运行结果为：0123 （如果不提供start则默认从第一个字符开始）
print str[4:]  # 运行结果为：456（如果不提供finish则默认一直到字符最后一个位置）
```

**注意：**字符串不能单独改变字符串中的某个下标的值。

```python
# 例：
str='hello'
str[0]='a'  # 错误！

str='hello'
str='123'  # 可通过
```

但是可以通过切片改变字符串中的某个下标的值（实则是字符串的替换而不是改变某一个下标的值）。
```python
# 例：
str='01234'
str=str[ :2] + '9' + str[3: ]  # 截取字符串0~1的部分+'9'+字符串3~end的部分（完整写法：str=str[0:2]+'9'+str[3:5]）
print str  # 输出内容：01934
```



### 计数参数
>选择性的输出列表内容

**参数：**`str[start : finish : countBy] `，其中`countBy`默认值为1。

```python
# 例：
str='0123456'
print str[0:7:2]  # 输出下标0~6之间，能被2整除的内容（包括下标0）输出内容：0246
print str[0:7:3]  # 输出下标0~6之间，能被3整除的内容（包括下标0）输出内容：036
print str[ : : 3]  # 输出整个字符串下标能被3整除的内容（包括下标0）输出内容：036’
print str[ : : -1]  # 逆序输出整个字符串，输出内容：6543210
```





## if-else

```python
'''
if 条件：
    缩进语句块
else：
    缩进语句块
'''

# 例：
if a>b:
	print a
else:
	print b
```

**if语句嵌套：**

```python
if a>60:
    if b>70:
        print a+b
    else:
        print a-b
elif c>80:  # 相当于else:if...(if-elif-else语句中，else条件放最后)
	print c
else:
	print d
```





## while 循环
```python
i=0
while i<5:
    print 'aaaa'
    i+=1  # 不能使用i++，python中不支持
```
**`break`和`continue`：**

```python
i=0
while i<10:
    print i
    if i==2:
        continue
    i+=1
```





## for语句
```python
for [一个数据] in [对象]:  # 类似于java的for-each
    print...

# 例：计算1+2+3+...+10的值
for a in range(11): 
    s+=a
print s
'''
range(n)			产生0~n-1的序列
range(2, 4)			产生2~3的序列
range(2, 10, 3)		随机产生2~9之间的三个序列
range(10, 2, -1)	产生10~3的递减序列（10,9,8,7...3）
'''

# 例：输出字符串中每一个值
for c in 'hello word': 
    print (c),
# 输出结果为：h e l l o   w o r d (逗号起到了输出不换的功能)
```





## 列表生成式（for的简写）

```python
[式子 for x in x的范围]  # 类似于for循环的简写形式，注意左方括号"["和右方括号"]"是不能缺的

# 例子：生成1*1，2*2，3*3...10*10的结果
[x*x for x in range(1, 11)]
# 输出结果：[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]

# 例子：在上一题的基础上，只选择计算偶数的平方
[i*i for i in range(1, 11) if i%2 == 0]
# 输出结果：[4, 16, 36, 64, 100]

# 例子：两层循环的使用
[a+b for a in 'ABC' for b in 'ABC']  # [式子] [for...] [for...]
['AX', 'AY', 'AZ', 'BX', 'BY', 'BZ', 'CX', 'CY', 'CZ']
```





## 字典(dict)和set

```python
d = ['aaa':11, 'bbb':22, 'ccc',33]

# 获取字典值
print (d['aaa'])  # 输出结果：11
print (d.get('aaa'))  # 输出结果：11
print (d.get('ddd'))  # 输出结果：None
print (d.get('ddd', -1))  # 查找不到，输出-1
# 使用get方法查找字典中没有的键会返回None或者自定义的值，而直接用下标查找则有可能运行出错

# 根据键存放值
d['bbb'] = 123
print(d['bbb'])  # 输出结果：123

# 判断字典中是否有此键
'aaa' in d  # 此式子返回的结果为：True

# 删除一个键
d.pop('ccc')
```

set是和字典差不多的东西，唯一的区别就是没有值，只有键，并且键不能重复。所有set是更精简的字典，适合用来存放不重复的简单数据

```python
s = set([1, 2, 3])  
print(s)  # [1, 2, 3]

s = set([1, 2, 2, 3, 3])
print(s)  # [1, 2, 3] 重复元素会自动被过滤掉

# 添加元素
s.add(4)
print(s)  # [1, 2, 3, 4]

# 删除元素
s.remove(4)  # 清除全部元素：s.clear()
print(s)  # [1, 2, 3]

# set之间可以进行交、并集运算
s1 = set([1, 2, 3])
s2 = set([2, 3, 4])
s1 & s2  # [2, 3]
s1 | s2  # [1, 2, 3, 4]
```





## lambda表达式

又称匿名函数，是函数的精简写法，类似于**for循环**和**列表生成器**

```python
lambda x: x*x
'''
等同于：
def f(x):
    return x*x
'''
```





## With Open

```python
with open( '/path/to/file', 'r' ) as f:
	print(f.read())

'''
等同于：
try:
	f = open('/path/to/file', 'r')
	print(f.read())
finally:
	if f:
		f.close()
'''

# f.read(): 读取全部文件内容
# f.read(size): 每次读取size个字节内容
# f.readline(): 每次读取一行的内容
# f.readlines(): 读取全部内容，但结果是个list，每行内容是一个元素


# 大文件下载：
with open('./img/image3.png', 'wb') as f:
    for chunk in r.iter_content(chunk_size=32):
        f.write(chunk)
```





## 文件打开模式

| 模式 | 描述                                                         |
| ---- | ------------------------------------------------------------ |
| b    | 二进制模式                                                   |
| +    | 打开一个文件进行更新（可读可写）                             |
| r    | **只读**，指针指向文件的开头。这是**默认模式**               |
| w    | **只写**，如果已存在则打开，并从头开始写入。如果该文件不存在，创建新文件。 |
| a    | **追加**，如果该文件已存在，针指向文件的结尾。如果该文件不存在，创建新文件进行写入。 |

上面内容可以进行组合使用，例如`r+`，`w+`，`ab`等，如果使用了`+`符号，则文件具备**读**与**写**两个功能，区别就是`r`和`w`的指针位置和当文件不存在时，是否会创建新文件。如果增加了`b`符号，则操作都是以二进制格式进行的。 





## 多进程

```python
import multiprocessing as mp


# 测试函数
def job(a, b):
    print(a, b)


# 无进程池写法
def mp_test_1():
    t1 = mp.Process(target=job, args=(1, 2))  # 被调用的函数不能包含括号，参数放在args中
    t2 = mp.Process(target=job, args=(3, 4))
    t3 = mp.Process(target=job, args=(5, 6))
    t1.start()  # 启动进程
    t2.start()
    t3.start()
    t1.join()  # 连接进程
    t2.join()
    t3.join()


# 有进程池写法
def mp_test_2():
    pool = mp.Pool(4)  # 定义CPU核数为4，如果不写此参数，则是当前系统CPU的核数
    for i in range(100):
        pool.apply_async(job, (i, i * 2,))  # 参数后面需要加入一个逗号，因为参数是需要迭代运算的值
    pool.close()  # 关闭进程池（pool），使其不在接受新的任务
    pool.join()  # 主进程阻塞等待子进程的退出， join方法要在close或terminate之后使用。


if __name__ == '__main__':
    mp_test_1()
    mp_test_2()
```





## 断言

当断言的条件语句为`False`时，将触发`AssertionError`错误，并终止程序抛出异常。

和`if`语句的区别是：
	`if`不会终止程序，但是断言会
	`if`在条件为真的时候执行里面的内容，但是断言是条件为假的时候执行里面的内容

```python
# assert 条件语句1, 条件语句2, [报错后要执行的语句]
# 条件语句后面的逗号不能忽略，特别是只有一个条件语句的时候依旧需要逗号

assert False  # 输出：AssertionError
assert False, "Error!"  # 输出：AssertionError: Error!
```

断言可用来防御性的编程上，对于一个没完善的程序，我们不知道它会在哪里会出错，与其让它在运行时崩溃，不如在出现错误条件时就崩溃，从而更方便调试寻找错误。





## 常用方法和语句

**生成随机数**

```python
import random
random.randint(0, 9)  # 生成0-9的随机数，包含0和9
```

**正则匹配**

```python
import re
content = "这是一段文本"
str = re.search(r'正则表达式', content).group()  # 匹配符合要求的内容并返回
print(str)
```

