# ADB命令总结



## 基础命令

| 命令                               | 作用                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| adb remount                        | 将system分区重新挂载为可读写分区                             |
| `adb reboot [bootloader|recovery]` | 重启，可增加参数<br />bootloader是重启到Fastboot模式<br />recovery是进入恢复模式 |
| adb root                           |                                                              |
| adb disable-verity                 |                                                              |
|                                    |                                                              |
|                                    |                                                              |
|                                    |                                                              |
|                                    |                                                              |
|                                    |                                                              |





## 设备连接

| 命令               | 作用                                                       |
| ------------------ | ---------------------------------------------------------- |
| `adb devices [-l]` | 查看连接计算机的设备，-l可显示更多信息，多设备时更方便查看 |
| adb kill-server    | 终止adb服务进程                                            |
| adb start-server   | 重启adb服务进程                                            |
| adb -s 设备号      | 当有多个设备时，可指定连接某个设备                         |
|                    |                                                            |



## 获取机器信息

| 命令                                        | 作用            |
| ------------------------------------------- | --------------- |
| adb get-serialno                            | 获取序列号      |
| adb shell  cat /sys/class/net/wlan0/address | 获取机器MAC地址 |
| adb shell cat /proc/cpuinfo                 | 获取CPU序列号   |



## 进程操作

| 命令                  | 作用             |
| --------------------- | ---------------- |
| adb shell ps          | 查看进程列表     |
| adb shell ps -x [PID] | 查看指定进程状态 |
|                       |                  |



## 应用管理

| 命令                               | 作用             |
| ---------------------------------- | ---------------- |
| adb install [-r] xxx.apk           | 安装指定apk      |
| adb uninstall [-k] xxx.apk         | 卸载指定apk      |
| adb pull <手机文件路径> <本机路径> | 从手机中拷贝文件 |
| adb push <本机文件路径> <手机路径> | 上传文件到手机中 |
|                                    |                  |
|                                    |                  |
|                                    |                  |



## 屏幕

| 命令                            | 作用                                                         |
| ------------------------------- | ------------------------------------------------------------ |
| adb shell wm size 1422x720      | 将分辨率修改为 1422x720                                      |
| adb shell wm size reset         | 恢复原分辨率                                                 |
| adb shell wm density 160        | 屏幕密度修改为 160dpi                                        |
| adb shell wm density reset      | 恢复原屏幕密度                                               |
| adb shell wm overscan 0,0,0,100 | 四个数字分别表示距离左、上、右、下边缘的留白像素<br />以上命令表示将屏幕底部 100px留白 |
| adb shell wm overscan reset     | 恢复显示区域                                                 |
|                                 |                                                              |





## 硬按键模拟

```shell
adb shell input keyevent [key值]

# input后面可使用的参数还有：[text | tap | swipe | draganddrop | press | roll]
# 在焦点处于某文本框时，可以通过 adb shell input text hello，来输入一串文本
# 如果需要实现滑动动作，可以通过 adb shell input swipe 起始点x坐标 起始点y坐标 结束点x坐标 结束点y坐标
```

| key值 | 对应按键 |
| ----- | -------- |
|**3**|**HOME 键**|
|**4**|**返回键**|
|5|打开拨号应用|
|6|挂断电话|
|24|增加音量|
|25|降低音量|
|**26**|**电源键**|
|27|拍照（需要在相机应用里）|
|64|打开浏览器|
|82|菜单键|
|85|播放/暂停|
|86|停止播放|
|87|播放下一首|
|88|播放上一首|
|122|移动光标到行首或列表顶部|
|123|移动光标到行末或列表底部|
|126|恢复播放|
|127|暂停播放|
|164|静音|
|176|打开系统设置|
|187|切换应用|
|207|打开联系人|
|208|打开日历|
|209|打开音乐|
|210|打开计算器|
|220|降低屏幕亮度|
|221|提高屏幕亮度|
|223|系统休眠|
|224|点亮屏幕|
|231|打开语音助手|
|276|如果没有 wakelock 则让系统休眠|





## dumpsys

```



# 查看顶部activity
dumpsys activity top | grep ACTIVITY

# 查看正在运行的Services
dumpsys activity services [<packagename>]

```



## am





## pm









## logcat

```
-c				清空缓冲区（main、system 和 crash），如需清除所有缓冲区，请使用 -b all -c
-d				将日志转储到屏幕并退出
-f <filename>	将日志消息输出写入 <filename>。默认值为 stdout
--pid=<pid>		仅输出来自给定 PID 的日志
```

### 级别

```
#例：adb logcat "*:W"
```

| 级别 | 含义                                                   |
| :--- | :----------------------------------------------------- |
| *:V  | 过滤只显示 Verbose 及以上级别(优先级最低)              |
| *:D  | 过滤只显示 Debug 及以上级别                            |
| *:I  | 过滤只显示 Info 及以上级别                             |
| *:W  | 过滤只显示 Warning 及以上级别                          |
| *:E  | 过滤只显示 Error 及以上级别                            |
| *:F  | 过滤只显示 Fatal 及以上级别                            |
| *:S  | 过滤只显示 Silent 及以上级别(优先级最高，什么也不输出) |

### 格式化

```
-v <format>		控制日志输出格式
注意：-v 只能指定一种格式化，但可以指定多个格式化修饰符

例：adb logcat -v thread
例：adb logcat -v color
```

| 格式化     | 含义                                                         |
| :--------- | :----------------------------------------------------------- |
| brief      | 显示优先级、标记以及发出消息的进程的 PID                     |
| long       | 显示所有元数据字段，并使用空白行分隔消息                     |
| process    | 仅显示 PID                                                   |
| raw        | 显示不包含其他元数据字段的原始日志消息                       |
| tag        | 仅显示优先级和标记                                           |
| thread     | 旧版格式，显示优先级、PID 以及发出消息的线程的 TID           |
| threadtime | 默认：显示日期、调用时间、优先级、标记、PID 以及发出消息的线程的 TID |
| time       | 显示日期、调用时间、优先级、标记以及发出消息的进程的 PID     |

| 格式修饰符 | 含义                                                   |
| ---------- | ------------------------------------------------------ |
| color      | 使用不同的颜色来显示每个优先级                         |
| uid        | 如果访问控制允许，则显示 UID 或记录的进程的 Android ID |
| usec       | 显示精确到微秒的时间                                   |
| UTC        | 显示 UTC 时间                                          |
| year       | 将年份添加到显示的时间                                 |
| zone       | 将本地时区添加到显示的时间                             |

### 缓冲区

```
-b <Buffer>		加载一个可使用的日志缓冲区供查看

例：logcat -b radio
例：logcat -b main -b radio -b events
例：logcat -b main,radio,events
```

| 缓冲区  | 含义                                               |
| :------ | :------------------------------------------------- |
| radio   | 查看包含无线装置/电话相关消息的缓冲区              |
| events  | 查看已经过解译的二进制系统事件缓冲区消息           |
| main    | 查看主日志缓冲区（默认），不包含系统和崩溃日志消息 |
| system  | 查看系统日志缓冲区（默认）                         |
| crash   | 查看崩溃日志缓冲区（默认）                         |
| all     | 查看所有缓冲区                                     |
| default | 报告 `main`、`system` 和 `crash` 缓冲区            |

















